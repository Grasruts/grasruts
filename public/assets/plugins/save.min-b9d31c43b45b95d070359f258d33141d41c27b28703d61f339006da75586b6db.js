!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):"object"==typeof module&&module.exports?module.exports=function(e,t){return t===undefined&&(t="undefined"!=typeof window?require("jquery"):require("jquery")(e)),n(t)}:n(window.jQuery)}(function(l){l.extend(l.FE.DEFAULTS,{saveInterval:1e4,saveURL:null,saveParams:{},saveParam:"body",saveMethod:"POST"}),l.FE.PLUGINS.save=function(i){function u(e,t){i.events.trigger("save.error",[{code:e,message:o[e]},t])}function t(e){void 0===e&&(e=i.html.get());var t=e,n=i.events.trigger("save.before",[e]);if(!1===n)return!1;if("string"==typeof n&&(e=n),i.opts.saveURL){var s={};for(var o in i.opts.saveParams)if(i.opts.saveParams.hasOwnProperty(o)){var a=i.opts.saveParams[o];s[o]="function"==typeof a?a.call(this):a}var r={};r[i.opts.saveParam]=e,l.ajax({type:i.opts.saveMethod,url:i.opts.saveURL,data:l.extend(r,s),crossDomain:i.opts.requestWithCORS,xhrFields:{withCredentials:i.opts.requestWithCredentials},headers:i.opts.requestHeaders}).done(function(e){v=t,i.events.trigger("save.after",[e])}).fail(function(e){u(d,e.response||e.responseText)})}else u(f)}function e(){clearTimeout(n),n=setTimeout(function(){var e=i.html.get();(v!=e||s)&&(s=!1,t(v=e))},i.opts.saveInterval)}var n=null,v=null,s=!1,f=1,d=2,o={};return o[f]="Missing saveURL option.",o[d]="Something went wrong during save.",{_init:function(){i.opts.saveInterval&&(v=i.html.get(),i.events.on("contentChanged",e),i.events.on("keydown destroy",function(){clearTimeout(n)}))},save:t,reset:function(){e(),s=!1},force:function(){s=!0}}},l.FE.DefineIcon("save",{NAME:"floppy-o",FA5NAME:"disk"}),l.FE.RegisterCommand("save",{title:"Save",undo:!1,focus:!1,refreshAfterCallback:!1,callback:function(){this.save.save()},plugin:"save"})});